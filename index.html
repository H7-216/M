<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XalaFlix - Films et SÃ©ries en Streaming</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a1a 100%);
            color: #ffffff;
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(90deg, #e50914 0%, #b81d24 100%);
            padding: 1rem 0;
            box-shadow: 0 4px 20px rgba(229, 9, 20, 0.3);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 2rem;
            font-weight: bold;
            color: #ffffff;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-links a {
            color: #ffffff;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: #ffd700;
        }

        .hero {
            background-size: cover;
            background-position: center;
            height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .hero-content h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #ffd700, #ff6b35);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero-content p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            opacity: 0.9;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .loading-message {
            text-align: center;
            padding: 2rem;
            color: #ffd700;
            font-size: 1.2rem;
        }

        .loading-message .spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 215, 0, 0.3);
            border-radius: 50%;
            border-top-color: #ffd700;
            animation: spin 1s ease-in-out infinite;
            margin-right: 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .search-container {
            margin: 2rem 0;
            text-align: center;
        }

        .search-box {
            display: inline-flex;
            background: rgba(255,255,255,0.1);
            border-radius: 30px;
            overflow: hidden;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .search-input {
            padding: 1rem 2rem;
            border: none;
            background: transparent;
            color: #ffffff;
            font-size: 1rem;
            width: 400px;
            outline: none;
        }

        .search-input::placeholder {
            color: rgba(255,255,255,0.7);
        }

        .search-btn {
            padding: 1rem 2rem;
            background: #e50914;
            border: none;
            color: #ffffff;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s ease;
        }

        .search-btn:hover {
            background: #b81d24;
        }

        .categories {
            margin: 3rem 0;
        }

        .category-nav {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .category-btn {
            padding: 0.8rem 1.5rem;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: #ffffff;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .category-btn:hover,
        .category-btn.active {
            background: #e50914;
            border-color: #e50914;
            transform: translateY(-2px);
        }

        .content-stats {
            text-align: center;
            margin-bottom: 2rem;
            color: rgba(255,255,255,0.7);
            font-size: 1rem;
        }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .content-card {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
        }

        .content-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            border-color: #e50914;
        }

        .card-image {
            height: 200px;
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #888;
            font-size: 1.2rem;
            position: relative;
        }

        .card-content {
            padding: 1.5rem;
        }

        .card-title {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            color: #ffd700;
        }

        .card-description {
            color: rgba(255,255,255,0.8);
            margin-bottom: 1rem;
            font-size: 0.9rem;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .card-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            font-size: 0.8rem;
            color: rgba(255,255,255,0.6);
        }

        .play-btn {
            width: 100%;
            padding: 0.8rem;
            background: linear-gradient(45deg, #e50914, #b81d24);
            border: none;
            color: #ffffff;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .play-btn:hover {
            background: linear-gradient(45deg, #b81d24, #e50914);
            transform: translateY(-2px);
        }

        .pagination {
            text-align: center;
            margin: 2rem 0;
        }

        .pagination button {
            padding: 0.8rem 1.5rem;
            margin: 0 0.5rem;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: #ffffff;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pagination button:hover,
        .pagination button.active {
            background: #e50914;
            border-color: #e50914;
        }

        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.9);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: relative;
            margin: 1% auto;
            width: 95%;
            height: 95%;
            background: #1a1a1a;
            border-radius: 15px;
            overflow: hidden;
            border: 2px solid #e50914;
            display: flex;
            flex-direction: column;
        }

        .modal-header {
            background: #e50914;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .close {
            color: #ffffff;
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: #ffd700;
        }

        .player-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .player-sidebar {
            width: 250px;
            background: #2a2a2a;
            padding: 1rem;
            overflow-y: auto;
            border-right: 1px solid #444;
        }

        .player-main {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .player-controls {
            background: #333;
            padding: 1rem;
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .server-btn {
            padding: 0.5rem 1rem;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: #ffffff;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .server-btn:hover,
        .server-btn.active {
            background: #e50914;
            border-color: #e50914;
        }

        .season-selector {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .season-btn {
            padding: 0.4rem 0.8rem;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: #ffffff;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8rem;
        }

        .season-btn:hover,
        .season-btn.active {
            background: #ffd700;
            color: #000;
            border-color: #ffd700;
        }

        .episode-list {
            margin-top: 1rem;
        }

        .episode-item {
            padding: 0.8rem;
            background: rgba(255,255,255,0.05);
            margin-bottom: 0.5rem;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .episode-item:hover {
            background: rgba(255,255,255,0.1);
            border-color: #e50914;
        }

        .episode-item.active {
            background: #e50914;
            border-color: #e50914;
        }

        .episode-title {
            font-weight: bold;
            margin-bottom: 0.3rem;
        }

        .episode-info {
            font-size: 0.8rem;
            color: rgba(255,255,255,0.7);
        }

        .video-container {
            flex: 1;
            position: relative;
            background: #000;
        }

        .video-frame {
            width: 100%;
            height: 100%;
            border: none;
        }

        .loading-spinner {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #e50914;
            font-size: 2rem;
        }

        @media (max-width: 768px) {
            .player-container {
                flex-direction: column;
            }
            
            .player-sidebar {
                width: 100%;
                max-height: 200px;
                order: 2;
            }
            
            .player-main {
                order: 1;
            }
            
            .player-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .server-btn {
                margin-bottom: 0.5rem;
            }

            .hero-content h1 {
                font-size: 2rem;
            }
            
            .search-input {
                width: 250px;
            }
            
            .nav-links {
                gap: 1rem;
            }
            
            .category-nav {
                gap: 0.5rem;
            }
            
            .category-btn {
                padding: 0.6rem 1rem;
                font-size: 0.9rem;
            }
        }

        .footer {
            background: #0c0c0c;
            padding: 2rem 0;
            margin-top: 4rem;
            text-align: center;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-section h3 {
            color: #e50914;
            margin-bottom: 1rem;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section ul li {
            margin-bottom: 0.5rem;
        }

        .footer-section ul li a {
            color: rgba(255,255,255,0.7);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-section ul li a:hover {
            color: #ffd700;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <nav class="nav">
                <a href="#" class="logo">ð¬ XalaFlix</a>
                <ul class="nav-links">
                    <li><a href="#" onclick="showCategory('all')">Accueil</a></li>
                    <li><a href="#" onclick="showCategory('films')">Films</a></li>
                    <li><a href="#" onclick="showCategory('series')">SÃ©ries</a></li>
                    <li><a href="#" onclick="showCategory('documentaires')">Documentaires</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="hero">
        <div class="hero-content">
            <h1>Votre CinÃ©ma Ã  la Maison</h1>
            <p>DÃ©couvrez des milliers de films et sÃ©ries en streaming haute qualitÃ©</p>
        </div>
    </section>

    <div class="container">
        <div class="search-container">
            <div class="search-box">
                <input type="text" class="search-input" placeholder="Rechercher un film, une sÃ©rie..." id="searchInput">
                <button class="search-btn" onclick="searchContent()">ð</button>
            </div>
        </div>

        <section class="categories">
            <div class="category-nav">
                <button class="category-btn active" onclick="showCategory('all')">Tous</button>
                <button class="category-btn" onclick="showCategory('films')">Films</button>
                <button class="category-btn" onclick="showCategory('series')">SÃ©ries</button>
                <button class="category-btn" onclick="showCategory('action')">Action</button>
                <button class="category-btn" onclick="showCategory('comedie')">ComÃ©die</button>
                <button class="category-btn" onclick="showCategory('drame')">Drame</button>
                <button class="category-btn" onclick="showCategory('sci-fi')">Sci-Fi</button>
                <button class="category-btn" onclick="showCategory('animation')">Animation</button>
            </div>

            <div class="content-stats" id="contentStats"></div>
            
            <div id="loadingMessage" class="loading-message">
                <div class="spinner"></div>
                Chargement du contenu depuis l'API...
            </div>

            <div class="content-grid" id="contentGrid" style="display: none;">
                <!-- Le contenu sera gÃ©nÃ©rÃ© par JavaScript -->
            </div>

            <div class="pagination" id="pagination" style="display: none;">
                <!-- La pagination sera gÃ©nÃ©rÃ©e par JavaScript -->
            </div>
        </section>
    </div>

    <!-- Modal pour la lecture vidÃ©o -->
    <div id="videoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title" id="modalTitle">Lecture en cours</span>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <div class="player-container">
                <div class="player-sidebar" id="playerSidebar">
                    <h3 style="margin-bottom: 1rem; color: #e50914;">Episodes</h3>
                    <div class="season-selector" id="seasonSelector">
                        <!-- Les saisons seront ajoutÃ©es ici -->
                    </div>
                    <div class="episode-list" id="episodeList">
                        <!-- Les Ã©pisodes seront ajoutÃ©s ici -->
                    </div>
                </div>
                <div class="player-main">
                    <div class="player-controls">
                        <div style="display: flex; gap: 0.5rem; align-items: center; flex-wrap: wrap;">
                            <span style="color: #fff; font-weight: bold;">Serveurs:</span>
                            <div id="serverButtons">
                                <!-- Les boutons serveurs seront ajoutÃ©s ici -->
                            </div>
                        </div>
                    </div>
                    <div class="video-container">
                        <div class="loading-spinner" id="loadingSpinner">â³ Chargement...</div>
                        <iframe class="video-frame" id="videoFrame" src="" allowfullscreen style="display: none;"></iframe>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Navigation</h3>
                    <ul>
                        <li><a href="#">Accueil</a></li>
                        <li><a href="#">Films</a></li>
                        <li><a href="#">SÃ©ries</a></li>
                        <li><a href="#">NouveautÃ©s</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Genres</h3>
                    <ul>
                        <li><a href="#">Action</a></li>
                        <li><a href="#">ComÃ©die</a></li>
                        <li><a href="#">Drame</a></li>
                        <li><a href="#">Science-Fiction</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Support</h3>
                    <ul>
                        <li><a href="#">Centre d'aide</a></li>
                        <li><a href="#">Contact</a></li>
                        <li><a href="#">Signaler un problÃ¨me</a></li>
                        <li><a href="#">FAQ</a></li>
                    </ul>
                </div>
            </div>
            <p style="opacity: 0.6; margin-top: 2rem;">&copy; 2025 XalaFlix. Tous droits rÃ©servÃ©s.</p>
        </div>
    </footer>

    <script>
        // Configuration des serveurs de streaming
        const streamingServers = {
            server1: "https://vidsrc.to/embed/movie/",
            server2: "https://vidsrc.me/embed/movie/",
            server3: "https://2embed.org/embed/movie/",
            server4: "https://www.2embed.ru/embed/imdb/movie/",
            seriesServer1: "https://vidsrc.to/embed/tv/",
            seriesServer2: "https://vidsrc.me/embed/tv/",
            seriesServer3: "https://2embed.org/embed/tv/"
        };

        // Base de donnÃ©es de contenu de secours
        const fallbackContentDatabase = [
            {
                id: 1,
                internalId: "movie_avatar2",
                imdbId: "tt1630029",
                tmdbId: "76600",
                title: "Avatar: La Voie de l'Eau",
                type: "films",
                category: "action",
                year: "2022",
                rating: "8.1",
                description: "Suite Ã©pique des aventures de Jake Sully et Neytiri sur Pandora.",
                poster: "https://image.tmdb.org/t/p/w500/5ScPNT6fHtfYJeWBajZciPV3hEL.jpg",
                backdrop: "https://image.tmdb.org/t/p/w1280/s16H6tpK2utvwDtzZ8Qy4qm5Emw.jpg",
                servers: ["server1", "server2", "server3"]
            },
            {
                id: 2,
                internalId: "series_stranger_things",
                imdbId: "tt4574334",
                tmdbId: "66732",
                title: "Stranger Things",
                type: "series",
                category: "sci-fi",
                year: "2016-2022",
                rating: "8.7",
                description: "Des enfants dÃ©couvrent des forces surnaturelles dans leur petite ville.",
                poster: "https://image.tmdb.org/t/p/w500/49WJfeN0moxb9IPfGn8AIqMGskD.jpg",
                backdrop: "https://image.tmdb.org/t/p/w1280/56v2KjBlU4XaOv9rVYEQypROD7P.jpg",
                seasons: 4,
                servers: ["seriesServer1", "seriesServer2", "seriesServer3"]
            },
            {
                id: 3,
                internalId: "movie_minecraft_film",
                title: "Minecraft - Le Film",
                type: "films",
                category: "animation",
                year: "2025",
                rating: "â",
                description: "L'adaptation tant attendue du cÃ©lÃ¨bre jeu vidÃ©o Minecraft au cinÃ©ma.",
                poster: "https://image.tmdb.org/t/p/w500/placeholder.jpg",
                backdrop: "https://image.tmdb.org/t/p/w1280/placeholder.jpg",
                iframeLink: "https://xalaflix.io/movies/watch/minecraft-le-film/2407",
                servers: ["direct"]
            }
        ];

        // Variables globales
        let allContent = [];
        let filteredContent = [];
        let currentFilter = 'all';
        let currentContent = null;
        let currentServer = null;
        let currentSeason = 1;
        let currentEpisode = 1;
        let currentPage = 1;
        let itemsPerPage = 12;
        let totalPages = 0;

        // Chargement du contenu depuis l'API XalaFlix
        async function loadContentFromAPI() {
            try {
                console.log('Tentative de chargement depuis l\'API XalaFlix...');
                
                // URL de l'API
                const apiUrl = 'https://xalaflix.io/api/';
                
                // Options pour la requÃªte
                const requestOptions = {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        // 'Authorization': 'Bearer VOTRE_TOKEN_ICI' // Si nÃ©cessaire
                    }
                };
                
                const response = await fetch(apiUrl, requestOptions);
                
                if (!response.ok) {
                    throw new Error(`Erreur HTTP! statut: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('DonnÃ©es reÃ§ues de l\'API:', data);
                
                // Transformer les donnÃ©es de l'API dans notre format
                const loadedContent = data.map(item => {
                    return {
                        id: item.id,
                        internalId: item.slug || `item_${item.id}`,
                        imdbId: item.imdb_id,
                        tmdbId: item.tmdb_id,
                        title: item.title,
                        type: item.type === 'movie' ? 'films' : 'series',
                        category: mapCategory(item.genres),
                        year: item.release_date ? item.release_date.substring(0, 4) : 'N/A',
                        rating: item.vote_average ? item.vote_average.toFixed(1) : 'â',
                        description: item.overview || 'Description non disponible',
                        poster: item.poster_path ? `https://image.tmdb.org/t/p/w500${item.poster_path}` : null,
                        backdrop: item.backdrop_path ? `https://image.tmdb.org/t/p/w1280${item.backdrop_path}` : null,
                        iframeLink: item.video_url || null,
                        servers: ["server1", "server2", "server3"],
                        seasons: item.type === 'series' ? item.number_of_seasons || 1 : undefined,
                        episodes: item.type === 'series' ? item.number_of_episodes || 10 : undefined
                    };
                });
                
                console.log(`${loadedContent.length} films/sÃ©ries extraits de l'API`);
                
                if (loadedContent.length > 0) {
                    allContent = loadedContent;
                    console.log('Contenu chargÃ© depuis l\'API avec succÃ¨s');
                    
                    // Mettre Ã  jour l'image de fond de l'hÃ©ros avec un film alÃ©atoire
                    updateHeroBackground();
                } else {
                    throw new Error('Aucun contenu valide trouvÃ© dans l\'API');
                }
                
            } catch (error) {
                console.error('Erreur lors du chargement de l\'API:', error);
                console.log('Utilisation du contenu de secours');
                allContent = [...fallbackContentDatabase];
                
                // Mettre Ã  jour l'image de fond de l'hÃ©ros avec un film alÃ©atoire
                updateHeroBackground();
            }
            
            // Initialiser l'affichage
            initializeContent();
        }

        // Mapper les catÃ©gories/genres
        function mapCategory(genres) {
            if (!genres || genres.length === 0) return 'drame';
            
            const primaryGenre = genres[0].toLowerCase();
            
            if (primaryGenre.includes('action') || primaryGenre.includes('aventure')) {
                return 'action';
            } else if (primaryGenre.includes('comÃ©die') || primaryGenre.includes('comedy')) {
                return 'comedie';
            } else if (primaryGenre.includes('science-fiction') || primaryGenre.includes('sci-fi')) {
                return 'sci-fi';
            } else if (primaryGenre.includes('animation') || primaryGenre.includes('anime')) {
                return 'animation';
            } else if (primaryGenre.includes('drame') || primaryGenre.includes('drama')) {
                return 'drame';
            } else if (primaryGenre.includes('documentaire')) {
                return 'documentaires';
            }
            
            return 'drame';
        }

        // Mettre Ã  jour l'arriÃ¨re-plan de l'hÃ©ros avec un film alÃ©atoire
        function updateHeroBackground() {
            const heroSection = document.querySelector('.hero');
            const movies = allContent.filter(item => item.type === 'films' && item.backdrop);
            
            if (movies.length > 0) {
                const randomMovie = movies[Math.floor(Math.random() * movies.length)];
                heroSection.style.background = `linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('${randomMovie.backdrop}')`;
                heroSection.style.backgroundSize = 'cover';
                heroSection.style.backgroundPosition = 'center';
                
                // Mettre Ã  jour le texte de l'hÃ©ros
                const heroContent = document.querySelector('.hero-content');
                heroContent.querySelector('h1').textContent = randomMovie.title;
                heroContent.querySelector('p').textContent = randomMovie.description.substring(0, 150) + '...';
            }
        }

        // Initialiser le contenu aprÃ¨s chargement
        function initializeContent() {
            document.getElementById('loadingMessage').style.display = 'none';
            document.getElementById('contentGrid').style.display = 'grid';
            document.getElementById('pagination').style.display = 'block';
            
            showCategory('all');
            updateContentStats();
        }

        // Mettre Ã  jour les statistiques de contenu
        function updateContentStats() {
            const stats = document.getElementById('contentStats');
            const totalMovies = allContent.filter(item => item.type === 'films').length;
            const totalSeries = allContent.filter(item => item.type === 'series').length;
            
            stats.innerHTML = `
                ð ${allContent.length} contenus disponibles 
                (${totalMovies} films, ${totalSeries} sÃ©ries)
            `;
        }

        // Afficher le contenu avec pagination
        function renderContent(content, page = 1) {
            const grid = document.getElementById('contentGrid');
            const pagination = document.getElementById('pagination');
            
            // Calculer la pagination
            currentPage = page;
            totalPages = Math.ceil(content.length / itemsPerPage);
            const startIndex = (page - 1) * itemsPerPage;
            const endIndex = Math.min(startIndex + itemsPerPage, content.length);
            const paginatedContent = content.slice(startIndex, endIndex);
            
            // Vider la grille
            grid.innerHTML = '';
            
            // Remplir avec le contenu paginÃ©
            paginatedContent.forEach(item => {
                const card = document.createElement('div');
                card.className = 'content-card';
                card.dataset.id = item.internalId;
                
                // CrÃ©er une image de placeholder si pas d'image disponible
                const posterBackground = item.poster ? 
                    `background-image: url('${item.poster}')` : 
                    `background: linear-gradient(45deg, ${getColorFromText(item.title)}, #555)`;
                
                card.innerHTML = `
                    <div class="card-image" style="${posterBackground}">
                        ${item.poster ? '' : item.title}
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">${item.title}</h3>
                        <p class="card-description">${item.description}</p>
                        <div class="card-meta">
                            <span>${item.year}</span>
                            <span>â­ ${item.rating}</span>
                        </div>
                        <button class="play-btn" onclick="openModal('${item.internalId}')">
                            ${item.type === 'series' ? 'Voir les Ã©pisodes' : 'Regarder'}
                        </button>
                    </div>
                `;
                
                grid.appendChild(card);
            });
            
            // Mettre Ã  jour la pagination
            updatePagination(content.length);
        }

        // Mettre Ã  jour la pagination
        function updatePagination(totalItems) {
            const pagination = document.getElementById('pagination');
            pagination.innerHTML = '';
            
            // Bouton PrÃ©cÃ©dent
            const prevButton = document.createElement('button');
            prevButton.textContent = 'PrÃ©cÃ©dent';
            prevButton.disabled = currentPage === 1;
            prevButton.onclick = () => {
                renderContent(filteredContent, currentPage - 1);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };
            pagination.appendChild(prevButton);
            
            // Boutons de page
            const maxVisiblePages = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
            
            if (endPage - startPage + 1 < maxVisiblePages) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }
            
            if (startPage > 1) {
                const firstPageButton = document.createElement('button');
                firstPageButton.textContent = '1';
                firstPageButton.onclick = () => {
                    renderContent(filteredContent, 1);
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                };
                pagination.appendChild(firstPageButton);
                
                if (startPage > 2) {
                    const ellipsis = document.createElement('span');
                    ellipsis.textContent = '...';
                    pagination.appendChild(ellipsis);
                }
            }
            
            for (let i = startPage; i <= endPage; i++) {
                const pageButton = document.createElement('button');
                pageButton.textContent = i;
                pageButton.className = i === currentPage ? 'active' : '';
                pageButton.onclick = () => {
                    renderContent(filteredContent, i);
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                };
                pagination.appendChild(pageButton);
            }
            
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    const ellipsis = document.createElement('span');
                    ellipsis.textContent = '...';
                    pagination.appendChild(ellipsis);
                }
                
                const lastPageButton = document.createElement('button');
                lastPageButton.textContent = totalPages;
                lastPageButton.onclick = () => {
                    renderContent(filteredContent, totalPages);
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                };
                pagination.appendChild(lastPageButton);
            }
            
            // Bouton Suivant
            const nextButton = document.createElement('button');
            nextButton.textContent = 'Suivant';
            nextButton.disabled = currentPage === totalPages;
            nextButton.onclick = () => {
                renderContent(filteredContent, currentPage + 1);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };
            pagination.appendChild(nextButton);
        }

        // Filtrer le contenu par catÃ©gorie
        function showCategory(category) {
            currentFilter = category;
            currentPage = 1;
            
            // Mettre Ã  jour les boutons de catÃ©gorie actifs
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.toggle('active', btn.textContent.toLowerCase() === category);
            });
            
            // Filtrer le contenu
            if (category === 'all') {
                filteredContent = [...allContent];
            } else {
                filteredContent = allContent.filter(item => 
                    item.type === category || item.category === category
                );
            }
            
            // Afficher le contenu filtrÃ©
            renderContent(filteredContent);
            
            // Mettre Ã  jour les stats
            updateContentStats();
        }

        // Rechercher du contenu
        function searchContent() {
            const searchInput = document.getElementById('searchInput');
            const query = searchInput.value.toLowerCase().trim();
            
            if (query === '') {
                showCategory(currentFilter);
                return;
            }
            
            filteredContent = allContent.filter(item => 
                item.title.toLowerCase().includes(query) || 
                item.description.toLowerCase().includes(query)
            );
            
            currentPage = 1;
            renderContent(filteredContent);
            
            // Mettre Ã  jour les stats
            document.getElementById('contentStats').textContent = 
                `ð ${filteredContent.length} rÃ©sultats pour "${query}"`;
        }

        // Ouvrir la modal de lecture
        function openModal(contentId) {
            currentContent = allContent.find(item => item.internalId === contentId);
            if (!currentContent) return;
            
            // Mettre Ã  jour le titre de la modal
            document.getElementById('modalTitle').textContent = currentContent.title;
            
            // Afficher la modal
            const modal = document.getElementById('videoModal');
            modal.style.display = 'block';
            
            // Configurer en fonction du type de contenu (film ou sÃ©rie)
            if (currentContent.type === 'series') {
                setupSeriesModal();
            } else {
                setupMovieModal();
            }
            
            // Charger le premier serveur par dÃ©faut
            if (currentContent.servers && currentContent.servers.length > 0) {
                loadServer(currentContent.servers[0]);
            }
        }

        // Configurer la modal pour les films
        function setupMovieModal() {
            const sidebar = document.getElementById('playerSidebar');
            sidebar.innerHTML = '<h3 style="margin-bottom: 1rem; color: #e50914;">Informations</h3>' +
                `<p><strong>Titre:</strong> ${currentContent.title}</p>` +
                `<p><strong>AnnÃ©e:</strong> ${currentContent.year}</p>` +
                `<p><strong>Note:</strong> ${currentContent.rating}</p>` +
                `<p><strong>Description:</strong> ${currentContent.description}</p>`;
            
            // Configurer les boutons serveurs
            setupServerButtons();
        }

        // Configurer la modal pour les sÃ©ries
        function setupSeriesModal() {
            const sidebar = document.getElementById('playerSidebar');
            const seasonSelector = document.getElementById('seasonSelector');
            const episodeList = document.getElementById('episodeList');
            
            // Afficher le sÃ©lecteur de saisons
            seasonSelector.innerHTML = '<span style="color: #fff; font-weight: bold;">Saison:</span>';
            for (let i = 1; i <= currentContent.seasons; i++) {
                const seasonBtn = document.createElement('button');
                seasonBtn.className = 'season-btn' + (i === currentSeason ? ' active' : '');
                seasonBtn.textContent = i;
                seasonBtn.onclick = () => {
                    currentSeason = i;
                    document.querySelectorAll('.season-btn').forEach(btn => 
                        btn.classList.remove('active')
                    );
                    seasonBtn.classList.add('active');
                    loadEpisodesForSeason(i);
                };
                seasonSelector.appendChild(seasonBtn);
            }
            
            // Charger les Ã©pisodes de la premiÃ¨re saison
            loadEpisodesForSeason(1);
            
            // Configurer les boutons serveurs
            setupServerButtons();
        }

        // Charger les Ã©pisodes pour une saison donnÃ©e
        function loadEpisodesForSeason(season) {
            const episodeList = document.getElementById('episodeList');
            episodeList.innerHTML = '';
            
            // GÃ©nÃ©rer des Ã©pisodes factices (10 par saison)
            const episodeCount = currentContent.episodes || 10;
            for (let i = 1; i <= episodeCount; i++) {
                const episodeItem = document.createElement('div');
                episodeItem.className = 'episode-item' + (i === currentEpisode && season === currentSeason ? ' active' : '');
                episodeItem.innerHTML = `
                    <div class="episode-title">Ãpisode ${i}</div>
                    <div class="episode-info">Titre de l'Ã©pisode ${i}</div>
                `;
                episodeItem.onclick = () => {
                    currentEpisode = i;
                    currentSeason = season;
                    document.querySelectorAll('.episode-item').forEach(item => 
                        item.classList.remove('active')
                    );
                    episodeItem.classList.add('active');
                    loadCurrentEpisode();
                };
                episodeList.appendChild(episodeItem);
            }
        }

        // Configurer les boutons serveurs
        function setupServerButtons() {
            const serverButtons = document.getElementById('serverButtons');
            serverButtons.innerHTML = '';
            
            if (!currentContent.servers || currentContent.servers.length === 0) {
                const noServerBtn = document.createElement('button');
                noServerBtn.className = 'server-btn';
                noServerBtn.textContent = 'Aucun serveur disponible';
                noServerBtn.disabled = true;
                serverButtons.appendChild(noServerBtn);
                return;
            }
            
            currentContent.servers.forEach(serverKey => {
                const serverBtn = document.createElement('button');
                serverBtn.className = 'server-btn';
                serverBtn.textContent = `Serveur ${serverKey.replace('server', '').replace('Server', '')}`;
                serverBtn.onclick = () => loadServer(serverKey);
                serverButtons.appendChild(serverBtn);
            });
        }

        // Charger un serveur spÃ©cifique
        function loadServer(serverKey) {
            currentServer = serverKey;
            
            // Mettre Ã  jour le bouton serveur actif
            document.querySelectorAll('.server-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.includes(serverKey.replace('server', '').replace('Server', ''))) {
                    btn.classList.add('active');
                }
            });
            
            // Afficher le spinner de chargement
            document.getElementById('loadingSpinner').style.display = 'block';
            document.getElementById('videoFrame').style.display = 'none';
            
            // Simuler un dÃ©lai de chargement
            setTimeout(() => {
                loadCurrentEpisode();
            }, 1000);
        }

        // Charger l'Ã©pisode actuel (pour les sÃ©ries) ou le film
        function loadCurrentEpisode() {
            const videoFrame = document.getElementById('videoFrame');
            const loadingSpinner = document.getElementById('loadingSpinner');
            
            if (currentContent.type === 'series') {
                // Construire l'URL pour une sÃ©rie
                const seriesId = currentContent.imdbId || currentContent.tmdbId || currentContent.internalId;
                const serverUrl = streamingServers[currentServer];
                
                if (serverUrl && seriesId) {
                    videoFrame.src = `${serverUrl}${seriesId}/${currentSeason}/${currentEpisode}`;
                } else if (currentContent.iframeLink) {
                    // Utiliser le lien direct s'il existe
                    videoFrame.src = currentContent.iframeLink;
                } else {
                    // Fallback pour les dÃ©mos
                    videoFrame.srcdoc = `
                        <html><body style="margin:0;background:#000;display:flex;justify-content:center;align-items:center;height:100%;color:#fff;">
                        <div style="text-align:center;">
                            <h2>${currentContent.title}</h2>
                            <p>Saison ${currentSeason} - Ãpisode ${currentEpisode}</p>
                            <p>Lecture simulÃ©e - Serveur ${currentServer}</p>
                        </div>
                        </body></html>
                    `;
                }
            } else {
                // Construire l'URL pour un film
                const movieId = currentContent.imdbId || currentContent.tmdbId || currentContent.internalId;
                const serverUrl = streamingServers[currentServer];
                
                if (serverUrl && movieId) {
                    videoFrame.src = `${serverUrl}${movieId}`;
                } else if (currentContent.iframeLink) {
                    // Utiliser le lien direct s'il existe
                    videoFrame.src = currentContent.iframeLink;
                } else {
                    // Fallback pour les dÃ©mos
                    videoFrame.srcdoc = `
                        <html><body style="margin:0;background:#000;display:flex;justify-content:center;align-items:center;height:100%;color:#fff;">
                        <div style="text-align:center;">
                            <h2>${currentContent.title}</h2>
                            <p>Lecture simulÃ©e - Serveur ${currentServer}</p>
                        </div>
                        </body></html>
                    `;
                }
            }
            
            // Cacher le spinner et afficher la vidÃ©o aprÃ¨s un court dÃ©lai
            setTimeout(() => {
                loadingSpinner.style.display = 'none';
                videoFrame.style.display = 'block';
            }, 1500);
        }

        // Fermer la modal
        function closeModal() {
            const modal = document.getElementById('videoModal');
            const videoFrame = document.getElementById('videoFrame');
            
            // ArrÃªter la vidÃ©o
            videoFrame.src = '';
            videoFrame.srcdoc = '';
            
            // Cacher la modal
            modal.style.display = 'none';
        }

        // GÃ©nÃ©rer une couleur Ã  partir d'un texte (pour les placeholders)
        function getColorFromText(text) {
            const colors = [
                '#3498db', '#e74c3c', '#2ecc71', '#f39c12', 
                '#9b59b6', '#1abc9c', '#d35400', '#34495e'
            ];
            
            let hash = 0;
            for (let i = 0; i < text.length; i++) {
                hash = text.charCodeAt(i) + ((hash << 5) - hash);
            }
            
            return colors[Math.abs(hash) % colors.length];
        }

        // GÃ©rer la touche EntrÃ©e dans la recherche
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchContent();
            }
        });

        // Fermer la modal en cliquant Ã  l'extÃ©rieur
        window.onclick = function(event) {
            const modal = document.getElementById('videoModal');
            if (event.target === modal) {
                closeModal();
            }
        };

        // Charger le contenu au dÃ©marrage
        document.addEventListener('DOMContentLoaded', function() {
            loadContentFromAPI();
            
            // Simuler un chargement plus long pour le dÃ©mo
            setTimeout(() => {
                if (document.getElementById('loadingMessage').style.display !== 'none') {
                    initializeContent();
                }
            }, 3000);
        });
    </script>
</body>
</html>